{
  "version": 2,
  "builds": [
    { 
      "src": "filings-frontend/package.json", 
      "use": "@vercel/static-build", 
      "config": { 
        "distDir": "filings-frontend/build",
        "buildCommand": "npm install --legacy-peer-deps && npm run build"
      } 
    },
    { 
      "src": "filings-backend/main.py", 
      "use": "@vercel/python", 
      "config": { 
        "requirements": "filings-backend/requirements.txt",
        "buildCommand": "pip install -r requirements.txt && uvicorn main:app --host 0.0.0.0 --port $PORT --workers 1 --uds /tmp/nginx.socket"
      } 
    }
  ],
  "routes": [
    { "src": "/(.*)", "dest": "filings-backend/app/main.py" },
    { "src": "/(.*)", "dest": "frontend/build/$1" }
  ]
}
